(()=>{"use strict";$(document).on("click","#btnCancel",(function(){$("#commentContainer").summernote("code","")})),$(document).on("click","#btnComment",(function(){var e=n.summernote("code"),t=$("#ownerId").val(),o=$("#moduleId").val();if(n.summernote("isEmpty"))return!1;var s=""===$("<div />").html($("#commentContainer").summernote("code")).text().trim().replace(/ \r\n\t/g,"");if($("#commentContainer").summernote("isEmpty"))$("#commentContainer").val("");else if(s){return displayErrorMessage("Comment field is not contain only white space"),$(this).button("reset"),!1}var a=$(this);a.button("loading"),$.ajax({url:route("comments.store"),type:"post",data:{description:e,owner_id:t,module_id:o},success:function(e){e.success&&function(e){var t=(o=e,s=o.id,a="",o.added_by==authId&&(a='                    <a class="user__icons del-comment d-none task-comment-delete" title="'+Lang.get("messages.common.delete")+'" data-id="'+s+'"><i class="fas fa-trash ml-0 card-delete-icon"></i></a>\n                    <a class="user__icons edit-comment d-none task-comment-edit" title="'+Lang.get("messages.common.edit")+'" data-id="'+s+'"><i class="fas fa-edit mr-2 card-edit-icon"></i></a>\n                    <a class="user__icons save-comment comment-save-icon-'+s+' d-none task-comment-check" data-id="'+s+'"><i class="far fa-check-circle card-save-icon text-success font-weight-bold hand-cursor mr-2 ml-2"></i></a>\n                    <a class="user__icons cancel-comment comment-cancel-icon-'+s+' d-none task-comment-cancel" data-id="'+s+'"><i class="fas fa-times card-cancel-icon hand-cursor"></i></a>\n'),'<div class="activity clearfix comments__information" id="comment__'+s+'">\n        <div class="activity-icon">\n            <img class="user__img profile" src="'+o.user.image_url+'" alt="User Image" width="50" height="50">\n            <span class="user__username">\n            </span>\n        </div>\n        <div class="activity-detail col-xl-11 col-lg-10 pt-1 mb-3">        <div class="mb-0 d-flex justify-content-between flex-wrap">        <div class="d-flex flex-wrap align-items-center">             <span class="font-weight-bold lead">'+o.user.full_name+'</span>\n            <span class="user__description text-job text-dark ml-2">Just now</span>\n        </div><div>'+a+'            </div></div>            <div class="user__comment mt-2 comment-display comment-display-'+s+'" data-id="'+s+'">\n'+o.description+'           </div>\n           <div class="user__comment d-none comment-edit comment-edit-'+s+'">\n           <div id="commentEditContainer'+s+'" class="quill-editor-container"></div>\n           </div>\n       </div>    </div>');var o,s,a;$(".comments .activities").prepend(t),n.summernote("code",""),$(".no_comments").hide()}(e.data),a.button("reset")},error:function(e){a.button("reset"),printErrorMessage("#taskValidationErrorsBox",e)}})})),$(document).on("click",".del-comment",(function(e){var n=$(this).data("id");swal({title:"Delete !",text:'Are you sure want to delete this "Comment" ?',type:"warning",showCancelButton:!0,closeOnConfirm:!1,showLoaderOnConfirm:!0,confirmButtonColor:"#6777ef",cancelButtonColor:"#d33",cancelButtonText:"No",confirmButtonText:"Yes"},(function(){$.ajax({url:route("comments.destroy",n),type:"DELETE",success:function(e){e.success&&function(e,n){$("#comment__"+e).remove(),$.ajax({url:ownerUrl+"/"+n+"/comments-count",type:"GET",success:function(e){0==e.data&&($(".no_comments").show(),$(".no_comments").removeClass("d-none"))}})}(n,ownerId),swal({title:"Deleted!",text:"Comment has been deleted.",type:"success",confirmButtonColor:"#6777ef",timer:2e3})},error:function(e){swal({title:"",text:e.responseJSON.message,type:"error",timer:5e3})}})}))}));var e=[];$(document).on("click",".comment-display,.edit-comment",(function(){var n=$(this).data("id");if($(document).find("[class*='comment-display-']").removeClass("d-none"),$(document).find("[class*='comment-edit-']").addClass("d-none"),$(document).find("[class*='comment-save-icon-']").addClass("d-none"),$(document).find("[class*='comment-cancel-icon-']").addClass("d-none"),$(".comment-display-"+n).addClass("d-none"),""===$("#commentEditContainer"+n).html())setCommentEditData(n);else{var t=$.trim($(".comment-display-"+n).html());e[n].summernote("code",""),e[n].summernote("code",t)}$(".comment-edit-"+n).removeClass("d-none"),$(".comment-save-icon-"+n).removeClass("d-none"),$(".comment-cancel-icon-"+n).removeClass("d-none")})),window.setCommentEditData=function(n){e[n]=$("#commentEditContainer"+n).summernote({placeholder:Lang.get("messages.comment.add_comment")+"...",minHeight:200,toolbar:[["style",["bold","italic","underline","clear"]],["font",["strikethrough"]],["para",["paragraph"]]]});var t=$.trim($(".comment-display-"+n).html());e[n].summernote("code",t)},$(document).on("click",".cancel-comment",(function(e){var n=$(this).data("id");$(this).addClass("d-none"),$(".comment-display-"+n).removeClass("d-none"),$(".comment-edit-"+n).addClass("d-none"),$(".comment-save-icon-"+n).addClass("d-none")})),$(document).on("click",".save-comment",(function(n){var t=$(this).data("id"),o=e[t].summernote("code"),s=$("#ownerId").val(),a=$("#moduleId").val();if(e[t].summernote("isEmpty"))return!1;var m=""===$("<div />").html($("#commentEditContainer"+t).summernote("code")).text().trim().replace(/ \r\n\t/g,"");if($("#commentEditContainer"+t).summernote("isEmpty"))$("#commentEditContainer"+t).val("");else if(m){return displayErrorMessage("Comment field is not contain only white space"),$(this).button("reset"),!1}$.ajax({url:route("comments.update",t),type:"put",data:{description:o,owner_id:s,module_id:a},success:function(e){e.success&&function(e,n){$(".comment-display-"+e).html(n).removeClass("d-none"),$(".comment-edit-"+e).addClass("d-none"),$(".comment-save-icon-"+e).addClass("d-none"),$(".comment-cancel-icon-"+e).addClass("d-none")}(t,o)},error:function(e){printErrorMessage("#taskValidationErrorsBox",e)}})})),$(document).on("mouseenter",".comments__information",(function(){$(this).find(".del-comment").removeClass("d-none"),$(this).find(".edit-comment").removeClass("d-none")})),$(document).on("mouseleave",".comments__information",(function(){$(this).find(".del-comment").addClass("d-none"),$(this).find(".edit-comment").addClass("d-none")}));var n=$("#commentContainer").summernote({placeholder:Lang.get("messages.comment.add_comment")+"...",minHeight:200,toolbar:[["style",["bold","italic","underline","clear"]],["font",["strikethrough"]],["para",["paragraph"]]]})})();