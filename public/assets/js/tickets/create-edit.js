(()=>{"use strict";$(document).ready((function(){$(document).on("submit","#createTicket, #editTicket",(function(){if(jQuery(this).find("#btnSave").button("loading"),""!==$("#error-msg").text())return!1;var e=""===$("<div />").html($("#ticketBody").summernote("code")).text().trim().replace(/ \r\n\t/g,"");if($("#ticketBody").summernote("isEmpty"))$("#ticketBody").val("");else if(e){return displayErrorMessage("Description field is not contain only white space"),jQuery(this).find("#btnSave").button("reset"),!1}})),$("#tagId").select2({width:"calc(100% - 44px)",placeholder:Lang.get("messages.placeholder.select_tags")}),$("#priorityId").select2({width:"calc(100% - 44px)"}),$("#serviceId").select2({width:"calc(100% - 44px)"}),$("#departmentId").select2({width:"calc(100% - 44px)"}),$("#predefinedReplyId").select2({width:"calc(100% - 44px)"}),$("#contactId,#assignToId").select2({width:"100%"}),$("#ticketStatusId").select2({width:"calc(100% - 44px)",placeholder:Lang.get("messages.placeholder.select_status")}),$(".ticketBody").summernote({dialogsInBody:!0,minHeight:150,toolbar:[["style",["bold","italic","underline","clear"]],["font",["strikethrough"]],["para",["paragraph"]]]}),$(document).on("click","#ticketContactBtn",(function(){$("#contactCol").hasClass("d-none")?($("#ticketContact").text(Lang.get("messages.ticket.ticket_without_contact")),$("#ticketContactIcon").attr("class","fas fa-envelope"),$("#contactCol").removeClass("d-none"),$("#nameCol").addClass("d-none")):($("#ticketContact").text(Lang.get("messages.ticket.ticket_to_contact")),$("#ticketContactIcon").attr("class","fas fa-user"),$("#contactCol").addClass("d-none"),$("#nameCol").removeClass("d-none"))})),$(document).on("change","#predefinedReplyId",(function(){var e=$(this).val();""!==e?$.ajax({url:route("ticket.reply.body",e),type:"GET",success:function(e){$(".ticketBody").summernote("code",e)}}):$(".ticketBody").summernote("code","")})),$(document).on("mouseenter",".ticket-attachment",(function(){$(this).find(".attachment-delete").removeClass("d-none")})),$(document).on("mouseleave",".ticket-attachment",(function(){$(this).find(".attachment-delete").addClass("d-none")})),$(document).on("click",".attachment-delete",(function(e){var t=$(e.currentTarget).data("id");swal({title:Lang.get("messages.common.delete")+"!",text:Lang.get("messages.common.delete_attachment"),type:"warning",showCancelButton:!0,closeOnConfirm:!1,showLoaderOnConfirm:!0,confirmButtonColor:"#6777ef",cancelButtonColor:"#d33",cancelButtonText:"No",confirmButtonText:"Yes"},(function(){$.ajax({url:ticketAttachmentUrl,type:"DELETE",dataType:"json",data:{mediaId:t},success:function(e){e.success&&window.location.reload(),swal({title:Lang.get("messages.common.deleted"),text:Lang.get("messages.common.attachment_deleted"),type:"success",confirmButtonColor:"#6777ef",timer:2e3})},error:function(e){swal({title:"",text:e.responseJSON.message,type:"error",confirmButtonColor:"#6777ef",timer:5e3})}})}))})),document.querySelector("#attachment").addEventListener("change",(function(t){if(!t.target.files||!window.FileReader)return;e.innerHTML="";for(var a=t.target.files,n=function(t){var n=a[t],i=new FileReader;i.onload=function(t){if(n.type.match("image*")){var a="<img class='img-thumbnail thumbnail-preview ticket-attachment' src=\""+t.target.result+'">';e.innerHTML+=a}else if(n.type.match("pdf*")){e.innerHTML+="<img class='img-thumbnail thumbnail-preview ticket-attachment' src=\"/assets/img/pdf_icon.png\">"}else if(n.type.match("zip*")){e.innerHTML+="<img class='img-thumbnail thumbnail-preview ticket-attachment' src=\"/assets/img/zip_icon.png\">"}else if(n.type.match("sheet*")){e.innerHTML+="<img class='img-thumbnail thumbnail-preview ticket-attachment' src=\"/assets/img/xlsx_icon.png\">"}else if(n.type.match("text*")){e.innerHTML+="<img class='img-thumbnail thumbnail-preview ticket-attachment' src=\"/assets/img/txt_icon.png\">"}else if(n.type.match("msword*")){e.innerHTML+="<img class='img-thumbnail thumbnail-preview ticket-attachment' src=\"/assets/img/doc_icon.png\">"}else e.innerHTML+=n.name},i.readAsDataURL(n)},i=0;i<a.length;i++)n(i)}),!1);var e=document.querySelector("#attachmentFileSection");$(document).on("mouseenter",".ticket-attachment",(function(){$(this).find(".ticket-attachment__icon").removeClass("d-none")})),$(document).on("mouseleave",".ticket-attachment",(function(){$(this).find(".ticket-attachment__icon").addClass("d-none")}))})),$(document).on("submit","#addTicketPriorityForm",(function(e){e.preventDefault(),processingBtn("#addTicketPriorityForm","#btnSave","loading"),$.ajax({url:route("ticketPriorities.store"),type:"POST",data:$(this).serialize(),success:function(e){if(e.success){displaySuccessMessage(e.message),$("#addTicketPriorityModal").modal("hide");var t={id:e.data.id,name:e.data.name},a=new Option(t.name,t.id,!1,!0);$("#priorityId").append(a).trigger("change")}},error:function(e){displayErrorMessage(e.responseJSON.message)},complete:function(){processingBtn("#addTicketPriorityForm","#btnSave")}})})),$("#addTicketPriorityModal").on("hidden.bs.modal",(function(){resetModalForm("#addTicketPriorityForm","#validationErrorsBox")})),$(document).on("submit","#addNewDepartmentForm",(function(e){e.preventDefault(),processingBtn("#addNewDepartmentForm","#btnSave","loading"),$.ajax({url:route("departments.store"),type:"POST",data:$(this).serialize(),success:function(e){if(e.success){displaySuccessMessage(e.message),$("#addDepartmentModal").modal("hide");var t={id:e.data.id,name:e.data.name},a=new Option(t.name,t.id,!1,!0);$("#departmentId").append(a).trigger("change")}},error:function(e){displayErrorMessage(e.responseJSON.message)},complete:function(){processingBtn("#addNewDepartmentForm","#btnSave")}})})),$("#addDepartmentModal").on("hidden.bs.modal",(function(){resetModalForm("#addNewDepartmentForm","#validationErrorsBox")})),$(document).on("submit","#addNewForm",(function(e){e.preventDefault(),processingBtn("#addNewForm","#btnSave","loading"),$.ajax({url:route("services.store"),type:"POST",data:$(this).serialize(),success:function(e){if(e.success){displaySuccessMessage(e.message),$("#addModal").modal("hide");var t={id:e.data.id,name:e.data.name},a=new Option(t.name,t.id,!1,!0);$("#serviceId").append(a).trigger("change")}},error:function(e){displayErrorMessage(e.responseJSON.message)},complete:function(){processingBtn("#addNewForm","#btnSave")}})})),$("#addModal").on("hidden.bs.modal",(function(){resetModalForm("#addNewForm","#validationErrorsBox")})),$(document).on("submit","#addTicketPredefinedForm",(function(e){e.preventDefault(),processingBtn("#addTicketPredefinedForm","#btnSave","loading"),$.ajax({url:route("predefinedReplies.store"),type:"POST",data:$(this).serialize(),success:function(e){if(e.success){displaySuccessMessage(e.message),$("#addTicketPredefinedModal").modal("hide");var t={id:e.data.id,name:e.data.reply_name},a=new Option(t.name,t.id,!1,!0);$("#predefinedReplyId").append(a).trigger("change")}},error:function(e){displayErrorMessage(e.responseJSON.message)},complete:function(){processingBtn("#addTicketPredefinedForm","#btnSave")}})})),$("#addTicketPredefinedModal").on("hidden.bs.modal",(function(){resetModalForm("#addTicketPredefinedForm","#validationErrorsBox")})),$(document).on("submit","#addTicketStatusForm",(function(e){e.preventDefault(),processingBtn("#addTicketStatusForm","#btnSave","loading"),$.ajax({url:route("ticket.status.store"),type:"POST",data:$(this).serialize(),success:function(e){if(e.success){displaySuccessMessage(e.message),$("#addTicketStatusModal").modal("hide");var t={id:e.data.id,name:e.data.name},a=new Option(t.name,t.id,!1,!0);$("#ticketStatusId").append(a).trigger("change")}},error:function(e){displayErrorMessage(e.responseJSON.message)},complete:function(){processingBtn("#addTicketStatusForm","#btnSave")}})})),$("#addTicketStatusModal").on("hidden.bs.modal",(function(){resetModalForm("#addTicketStatusForm","#validationErrorBox")}))})();